ãã‚Œã§ã¯ã€ã€ŒSwiftã®String(æ–‡å­—åˆ—) APIã¨ã®ä»˜ãåˆã„æ–¹ã€ã®ç™ºè¡¨ã‚’å§‹ã‚ã¾ã™ã€‚
https://swift-tweets.github.io ã®ç™ºè¡¨æ¦‚è¦ã«è¨˜è¼‰ã—ãŸé€šã‚Šã€ãã“ã«æŒ™ã’ã¦ã„ã‚‹3ã¤ã®è¨˜äº‹ã¯ç†è§£æ¸ˆã¿ã®å‰æã¨ã—ã¾ã™(ãã†ã§ãªãã¨ã‚‚åˆ†ã‹ã‚‹è©±ã‚‚å¤šã„ã¨æ€ã„ã¾ã™ãŒ)ã€‚

---

ã¾ãšSwiftã®æ–‡å­—åˆ—å‡¦ç†ã‚’ã‚³ãƒ¼ãƒ‰ä¾‹ã‚’äº¤ãˆãªãŒã‚‰è¦‹ã¦ã„ãã¾ã™ã€‚Swiftã®Stringã¯Characterãƒ»Unicode Scalarãƒ»UTF-16ãƒ»UTF-8ã¨ã„ã†4ã¤ã®View(è¡¨ç¾)ã‚’æŒã£ã¦ã„ã¾ã™ã€‚

---

é€šå¸¸ã®æ–‡å­—åˆ—å‡¦ç†ã§ã¯æ›¸è¨˜ç´ ã‚¯ãƒ©ã‚¹ã‚¿è¡¨ç¾ã§ã‚ã‚‹Character Viewã‚’ä¸»ã«æ‰±ã†ã“ã¨ã«ãªã‚‹ã¯ãšã§ã™ã€‚
æ›¸è¨˜ç´ ã‚¯ãƒ©ã‚¹ã‚¿ã¨ã¯ã€æŠ½è±¡æ–‡å­—ã™ãªã‚ã¡ç›®ã§è¦‹ãŸä¸€æ–‡å­—å˜ä½ã®é›†åˆã§ã™ã€‚

---

CharacterViewã¯Stringã‹ã‚‰`.characters`ã§ã‚¢ã‚¯ã‚»ã‚¹ã§ãã¦ã€å„ç¨®ä½¿ç”¨ä¾‹ã¯ã“ã‚Œã‚‰ã®ãƒªãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹ã«æ›¸ã‹ã‚Œã¦ã„ã¾ã™:

- https://developer.apple.com/reference/swift/string
- https://developer.apple.com/reference/swift/string.characterview

---

ãƒªãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹ã®Overviewã«ã‚ã‚‹é€šã‚Šä¸€èˆ¬çš„ãªæ–‡å­—åˆ—æ“ä½œãŒä¸€ã€…é¢å€’ã§ã™ã€‚ã‚«ã‚¦ãƒ³ãƒˆã™ã‚‹ã ã‘ã§ã‚‚charactersã‚’ä»‹ã™å¿…è¦ãŒã‚ã‚Šã€ã•ã‚‰ã«Intã«ã‚ˆã‚‹subscriptã‚‚ä¸å¯ã§Indexå‹ã«ã‚ˆã‚‹æ“ä½œã‚’å¼·ã„ã‚‰ã‚Œã¾ã™ã€‚

```swift:characters.swift
let str = "12345"

// ã‚«ã‚¦ãƒ³ãƒˆ
str.characters.count
// â†’ 5

// éƒ¨åˆ†æ–‡å­—åˆ—ã®å–å¾—
let index: String.CharacterView.Index = str.characters.index(of: "3")!
let chars: String.CharacterView = str.characters.prefix(upTo: index)
// Stringã«ã‚­ãƒ£ã‚¹ãƒˆå¿…è¦
String(chars)
// â†’ "12"
```

---

ã“ã†ã„ã£ãŸæ‰±ã„ã®ã—ã«ãã•ã¯ã€Swiftã®String APIãŒå³å¯†ã¨ãªã£ã¦ã„ã‚‹ãƒˆãƒ¬ãƒ¼ãƒ‰ã‚ªãƒ•ã§ã‚ã‚‹ã‚‚ã®ã®ã€ã¨ã¯ã„ãˆæ™®æ®µã®æ–‡å­—åˆ—å‡¦ç†ã®éš›ã«ä¸€ã€…ç…©é›‘ãªè¨˜è¿°ã‚’å¼·ã„ã‚‰ã‚Œã‚‹ã®ã¯æŠµæŠ—ã‚‚æ„Ÿã˜ã¾ã™ã€‚

---

ã“ã®æ‰±ã„ã«ãã•ã¸ã©ã†å¯¾å‡¦ã™ã‚‹ã®ãŒè‰¯ã„ã‹ã€ã„ãã¤ã‹ã®è¦³ç‚¹ã§è€ƒå¯Ÿã—ã¦ã„ãã¾ã™ã€‚
ã¾ãšCharacter Viewãªã©4ã¤ã®Viewã«åˆ†ã‹ã‚Œã¦ã„ã‚‹ã®ã¯ã€ã€Œæ–‡å­—åˆ—ã€ã¨ã„ã£ã¦ã‚‚è‰²ã€…ãªè¡¨ç¾ãŒã‚ã‚‹ã“ã¨ã«ä¾ã‚Šã¾ã™ã€‚

---

ãã‚ŒãŒäºˆã‚ãã¡ã‚“ã¨åˆ†é¡ã•ã‚Œã¦ã„ã‚‹ã®ã¯è‰¯ã„ã§ã™ãŒã€æœ€ã‚‚æ‰±ã†é »åº¦ã®å¤šã„Character Viewã‚’ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ç›´æ¥æ‰±ã„ãŸããªã£ã¦ãã¾ã™ã€‚
String APIã‚’è§¦ã£ã¦ã„ã‚‹ã¨å®Ÿã¯æ¨™æº–ã§ä¸­é€”åŠç«¯ã«ãã†ãªã£ã¦ã„ã‚‹ã“ã¨ãŒè¦‹å—ã‘ã‚‰ã‚Œã¾ã™ã€‚

---

ä¾‹ãˆã°ã€Stringã‹ã‚‰ã‚‚Indexã‚’å–å¾—ã§ãã¾ã™ãŒã€ãã‚Œã¯CharacterViewã®Indexã®typealiasã¨ã—ã¦å®šç¾©ã•ã‚Œã¦ã„ã‚‹ãŸã‚ã€å®Ÿã¯charactersã‚’ä»‹ã—ã¦å–å¾—ã—ãŸã‚‚ã®ã¾ã£ãŸãåŒã˜ã§ã™ã€‚

```swift:index.swift
// Stringã®Indexã¯æ¬¡ã®ã‚ˆã†ã«å®šç¾©ã•ã‚Œã¦ã„ã‚‹
public struct String {
  public typealias Index = String.CharacterView.Index
}

// ä»¥ä¸‹ã¯ã™ã¹ã¦true
str.startIndex == str.characters.startIndex
str.endIndex == str.characters.endIndex
String.Index.self == String.CharacterView.Index.self

// ä»¥ä¸‹ãªã©ã¯false
String.Index.self == String.UnicodeScalarView.Index.self
```

---

å–å¾—ã§ãã‚‹IndexãŒåŒä¸€ã¨ã„ã†ã“ã¨ã¯ã€ã™ãªã‚ã¡Stringã¯ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§Character Viewæ‰±ã„ã¨ãªã£ã¦ã„ã‚‹ã¨ã¿ãªã›ã‚‹ã®ã§ã¯ãªã„ã§ã—ã‚‡ã†ã‹ã€‚

---

ã‚«ã‚¦ãƒ³ãƒˆã‚‚ã€Indexè·é›¢ã‚’åˆ©ç”¨ã™ã‚‹ã“ã¨ã§ã€charactersã‚’ä»‹ã•ãšCharacter Viewã®countã¨åŒã˜ã‚‚ã®ã‚’å–å¾—ã™ã‚‹ã“ã¨ãŒå¯èƒ½ã§ã™ã€‚

```swift:count.swift
extension String {
    var countOriginal: Int {
        // ã“ã®æˆ»ã‚Šå€¤ã®å‹ã¯IndexDistanceã ãŒã€ãã‚Œã¯Intã®typealiasãªã®ã§ãã®ã¾ã¾è¿”ã›ã‚‹
        return distance(from: startIndex, to: endIndex)
    }
    // æ¬¡ã®ã‚ˆã†ã«æ›¸ã‘ã°è‰¯ã„ãŒã€ä¸Šã®ã¯`characters`ä½¿ã‚ãªã„ç¸›ã‚Š
    var count: Int {
        return characters.count
    }
}
```

---

ä»¥ä¸Šã®ã‚ˆã†ã«Stringã‹ã‚‰ç›´æ¥å–å¾—ã—ãŸIndexã¯Character Viewã®Indexæ“ä½œã«ä½¿ãˆã‚‹ã®ã§ã€Indexã¯charactersã‚’ä»‹ã•ãšã«æ¸ˆã¿å°‘ã—ã‚·ãƒ³ãƒ—ãƒ«ãªè¨˜è¿°ã¨ã§ãã¾ã™ã€‚

```swift:count2.swift
let str = "1ï¸âƒ£2ï¸âƒ£3ï¸âƒ£4ï¸âƒ£5ï¸âƒ£"
str.unicodeScalars.count
str.characters.count

let start = str.index(after: str.startIndex)
let end = str.index(start, offsetBy: 2)
// ä»¥ä¸‹ã®ã‚ˆã†ã«ã—ã¦ã‚‚åŒæ§˜ã«å‹•ããŒã€`.characters`ã¯çœç•¥å¯èƒ½
//let start = str.characters.index(after: str.startIndex)
//let end = str.characters.index(start, offsetBy: 2)

// subscriptæ“ä½œã‚‚charactersä»‹ã—ã¦ã‚‚ã©ã¡ã‚‰ã§ã‚‚åŒã˜
String(str[start...end])
String(str.characters[start...end])
// â†’ "2ï¸âƒ£3ï¸âƒ£4ï¸âƒ£"

// ä¸€æ–¹ã€ä¾‹ãˆã°ã€ä»¥ä¸‹ã®ã‚ˆã†ã«unicodeScalarsã‹ã‚‰å–å¾—ã—ãŸIndexã§charactersã®subscriptã‚’ã™ã‚‹ã¨å‹é•ã„ã§ã‚¨ãƒ©ãƒ¼ã«ãªã‚‹
do {
//    let start = str.unicodeScalars.index(after: str.unicodeScalars.startIndex)
//    let end = str.unicodeScalars.index(start, offsetBy: 2)
//    String(str.characters[start..<end])
//     â†’ error: cannot subscript a value of type 'String.CharacterView' with an index of type 'Range<String.UnicodeScalarView.Index>' String(str.characters[start..<end])
}
```

---

ã¾ãŸã€Stringã«ã¯ `substring` ãƒ¡ã‚½ãƒƒãƒ‰ã‚‚ã‚ã‚‹ã®ã§ã€æ¬¡ã®ã‚ˆã†ã«æ›¸ãã“ã¨ã‚‚ã§ãã¾ã™(ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã¯å°‘ã—åŠ£ã‚‹)ã€‚ã„ãšã‚Œã®æ–¹æ³•ã«ã›ã‚ˆã€charactersä»‹ã•ãªãã¦æ¸ˆã‚€ã¨ã“ã‚ã¯çœç•¥ã™ã‚‹ã¨å¤šå°‘æ¥½ã«ãªã‚Šã¾ã™ã€‚

```swift:substring.swift
str.substring(from: start).substring(to: end)
// â†’ "2ï¸âƒ£3ï¸âƒ£4ï¸âƒ£"
// ä»¥ä¸‹ã§ã‚‚åŒã˜
String(str[start...end])
String(str.characters[start...end])
String(str.characters.suffix(from: start).prefix(upTo: end))
String(str.characters.suffix(from: start).prefix(3))
```

---

ä»¥ä¸Šã®ã‚ˆã†ã«ã€APIã®ä½œã‚Šçš„ã«ã‚‚æŒ™å‹•çš„ã«ã‚‚Stringã¯ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§Character Viewæ‰±ã„ã¨ã¿ãªã›ã€ã‹ã¤ãã‚Œã‚’åˆ©ç”¨ã—ã¦å¤šå°‘æ¥½ã«ãªã‚‹ã¨æ€ã£ã¦ã„ã¾ã™ãŒã€ã¾ã å¤šå°‘é•å’Œæ„ŸãŒæ®‹ã£ã¦ã„ã¾ã™ã€‚
ä¸€ç•ªä¸æ€è­°ãªã®ã¯ã€Stringã«å¯¾ã—ã¦ç›´æ¥`count`ã§ããªã„ã“ã¨ã§ã™ã€‚

---

ã“ã‚Œã¯ã€StringãŒBidirectionalCollectionãƒ»RangeReplaceableCollectionã«æº–æ‹ ã™ã‚‹ã‚ˆã†ã«ã™ã‚Œã°ã€ã»ã¼charactersã¨åŒã˜ãƒ¡ã‚½ãƒƒãƒ‰ã‚’ç›´æ¥å‘¼ã¹ã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚

```swift:extension.swift
// ãƒ—ãƒ­ãƒˆã‚³ãƒ«å®Ÿè£…ã®å®£è¨€ã ã‘ã§OK
extension String: BidirectionalCollection, RangeReplaceableCollection {}

"hoge".count

// â†‘å®šç¾©ã«è¡Œãã¨æ¬¡ã«ãŸã©ã‚Šç€ã
//extension Collection {
//    public var count: Self.IndexDistance { get }
//}
```

---

ã“ã‚Œã‚’æ–½ã™ã¨countã ã‘ã§ãªãã€ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³æ“ä½œã‚„ã€`prefix`ãƒ»`suffix`ãªã©IntæŒ‡å®šã§éƒ¨åˆ†æ–‡å­—åˆ—å–å¾—ã§ãã‚‹ã‚ˆã†ã«ãªã£ãŸã‚Šã¨è‰²ã€…ä¾¿åˆ©ã«ãªã‚Šã¾ã™ã€‚

```swift:extension2.swift
for c in str {
    print(c)
}

str.prefix(3)
// â†’ "123"ã¨ã„ã†Stringå‹ã‚’ç›´æ¥å¾—ã‚‰ã‚Œã‚‹ï¼
str.characters.prefix(3)
// â†’ ã“ã®ã¾ã¾ã ã¨CharacterViewãªã®ã§ã€Stringã«ã™ã‚‹ã«ã¯ã‚­ãƒ£ã‚¹ãƒˆãŒå¿…è¦
String(str.characters.prefix(3))
```

---

ãŸã ã€ã“ã‚Œã¯ç½ ã‚‚ã‚ã‚Šãã†ãªã®ã§ã€æ³¨æ„ã—ã¦å–ã‚Šæ‰±ã£ãŸæ–¹ãŒè‰¯ã•ãã†ã§ã™ã€‚è©³ã—ãã¯ https://medium.com/swift-column/swift-string-16245b2723b4#.achuihxel ã«æ›¸ãã¾ã—ãŸãŒã€`var`ã§å®šç¾©ã—ãŸæ–‡å­—åˆ—ã«`removeFirst(_:)`ã‚’ä½¿ã†ã¨ã‚¯ãƒ©ãƒƒã‚·ãƒ¥ã—ã¦å¯¾å‡¦ãŒå¿…è¦ã§ã—ãŸã€‚

---

ãªã®ã§ã€ã“ã®æ–¹æ³•ã‚’ç”¨ã„ã‚‹ã‹ã©ã†ã‹ã®åˆ¤æ–­ã¯ãŠä»»ã›ã—ã¾ã™ã€‚åƒ•ã¯ã€æ–‡å­—åˆ—å†…å®¹ã«ã‚ˆã£ã¦ã‚¯ãƒ©ãƒƒã‚·ãƒ¥ã™ã‚‹ã“ã¨ã¯ç„¡ã•ãã†ãƒ»é–‹ç™ºæ®µéšã§ç½ ã‚‚å……åˆ†æ¤œçŸ¥ã§ãã‚‹ã ã‚ã†ã€ã¨æ„Ÿã˜ã¦ã„ã‚‹ã®ã§å®Ÿéš›ã«æ´»ç”¨ã—ã¦ã„ã¾ã™ã€‚

---

ä¸€æ—¦ã¾ã¨ã‚ã‚‹ã¨ã€Stringã¯å…ƒã€…Character Viewã‚’ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã¨ã¿ãªã—ã¦ã„ã‚‹ã‚ˆã†ãªã®ã§charactersãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã‚’çœç•¥ã™ã‚‹ã“ã¨ã§å¤šå°‘ç°¡æ½”ã«æ›¸ã‘ã‚‹ã“ã¨ã€ã•ã‚‰ã«Stringã‚’ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ç³»ã®ãƒ—ãƒ­ãƒˆã‚³ãƒ«ã«æº–æ‹ ã•ã›ã‚‹ã¨ã‚ˆã‚Šå¼·åŠ›ã«ãªã‚‹ã“ã¨ã‚’ç´¹ä»‹ã—ã¾ã—ãŸã€‚

---

æ¬¡ã«ã€Indexã®å–ã‚Šæ‰±ã„ã«ã¤ã„ã¦ã§ã™ã€‚ä»Šã¾ã§ã®ã‚³ãƒ¼ãƒ‰ä¾‹ã‚’è¦‹ã‚Œã°åˆ†ã‹ã‚‹é€šã‚Šã€Intã§ç›´æ¥subscriptæ“ä½œå‡ºæ¥ãšã«ã€startIndexãƒ»endIndexã‹ã‚‰ã®offsetã§è¾¿ã£ã¦ã„ãä½œã‚Šã«ãªã£ã¦ã„ã‚‹ã®ãŒé¢å€’ã§ã™ã€‚

---

ã‚‚ã¡ã‚ã‚“ã“ã‚Œã‚‚ç†ç”±ãŒã‚ã£ã¦ã€åƒ•ã¯ä¸»ãªç†ç”±ã¯é«˜ã‚³ã‚¹ãƒˆãªæ“ä½œã§ã‚ã‚‹ã“ã¨ã‚’æ„è­˜ã•ã›ã‚‹ã‚ˆã†ãªAPIã¨ãªã£ã¦ã„ã‚‹ã‹ã‚‰ã ã¨æ€ã£ã¦ã„ã¾ã™ã€‚

---

StringãŠã‚ˆã³ãã®Viewã¯RandomAccessCollectionã§ã¯ãªãBidirectionalCollectionã¨ã„ã†ã“ã¨ã‚‚ãƒã‚¤ãƒ³ãƒˆã§ã™:
- https://developer.apple.com/reference/swift/randomaccesscollection
- https://developer.apple.com/reference/swift/bidirectionalcollection

---

ç‰¹ã«Character Viewã«ãŠã„ã¦æŠ½è±¡æ–‡å­—ã™ãªã‚ã¡ç›®ã§è¦‹ãŸä½•æ–‡å­—ã‹ã¨ã„ã†æ¦‚å¿µã§æ–‡å­—åˆ—ã‚’èµ°æŸ»ãƒ»ã‚«ã‚¦ãƒ³ãƒˆã™ã‚‹ã®ã¯ã€ãã‚Œã‚‰ã®æ–‡å­—éƒ¨åˆ†ã«è‡³ã‚‹ã¾ã§å…ˆé ­ã‚ã‚‹ã„ã¯çµ‚ç«¯ã‹ã‚‰ã™ã¹ã¦èµ°æŸ»ã—ã¦ã„ãå¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚

---

ã“ã®æ€§è³ªãŒé¡•è‘—ã«è¡¨ã‚Œã¦ã„ã‚‹ã®ãŒ`count`ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã§ã€ãã®è¨ˆç®—é‡ã¯O(n)ã§ã™ã€‚
APIãƒ‡ã‚¶ã‚¤ãƒ³ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³ã«ã¯ã€ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã¯ `O(1)` ã§ã‚ã‚‹ã¹ãã§ã€ãã†ã§ãªã„å ´åˆã¯ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã«æ›¸ãã‚ˆã†ã«ã€è¨˜è¼‰ã•ã‚Œã¦ã„ã¦ã¡ã‚‡ã†ã©ãã®ä¾‹å¤–ã«ã‚ãŸã‚Šã¾ã™ã€‚

---

`count`ã«é™ã‚‰ãšã€åŒæ§˜ã«å¤šãã®æ–‡å­—åˆ—ã‚¢ã‚¯ã‚»ã‚¹ã¯ãã®æ€§è³ªä¸Š `O(n)` ã¨ãªã£ã¦ã„ã¾ã™ã€‚

---

Swiftã§ã¯æ‰€æœ›ã®Indexå–å¾—ã®APIã‚’å§‹ç«¯ãƒ»æœ«ç«¯ã‹ã‚‰ã®O(n)ã®èµ°æŸ»ã§ã‚ã‚‹ã“ã¨ã‚’æ„è­˜ã•ã›ã¦ã€Indexã‚’ç”¨ã„ãŸsubscriptãªã©ã®éƒ¨åˆ†æ–‡å­—åˆ—å–å¾—å‡¦ç†ã¯O(1)ã¨ã„ã†è¨­è¨ˆã«ãªã£ã¦ã„ã¾ã™ã€‚

---

æ–‡å­—åˆ—çµ‚ç«¯ä»˜è¿‘ã®Indexã‚’å§‹ç«¯ã‹ã‚‰è¾¿ã‚‹ã¨ã»ã¼æ–‡å­—åˆ—å…¨ã‚¹ã‚­ãƒ£ãƒ³ã¨ãªã‚Šã¾ã™ãŒã€çµ‚ç«¯ã‹ã‚‰ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ã¨O(1)ã«è¿‘ã„åŠ¹ç‡ã®è‰¯ã„å‡¦ç†ã¨ãªã‚Šã¾ã™ã€‚

```swift:performance.swift
// å¤šãã®è¨€èªã§ã¯ä»¥ä¸‹ã®ã‚ˆã†ã«ã‚‚subscriptã‚¢ã‚¯ã‚»ã‚¹ã§ãã‚‹ãŒã€ã“ã‚Œã§O(n)ã®å‡¦ç†ãŒ2ã¤èµ°ã‚‹ã€‚Swiftã®String APIã§ã¯ä¸å¯èƒ½
// str[str.length - 1]

// æœ«ç«¯ã‹ã‚‰ã®èµ°æŸ»ãªã®ã§O(1)ã§æ¸ˆã‚€
str[str.index(before: str.endIndex)..<str.endIndex]
str.substring(from: str.index(before: str.endIndex))

// Swiftã§ã‚‚å§‹ç«¯ã‹ã‚‰è¾¿ã‚‹ã¨O(n)ã®å‡¦ç†ãŒ2ã¤èµ°ã‚‹ã®ã§æ³¨æ„
str[str.index(str.startIndex, offsetBy: str.characters.count - 1)..<str.endIndex]
str.substring(from: str.index(str.startIndex, offsetBy: str.characters.count - 1))
```

---

ã—ã‹ã—ä»–ã®Intã§subscriptã‚¢ã‚¯ã‚»ã‚¹ã§ãã‚‹è¨€èªã§ã¯æ–‡å­—åˆ—ã‚¢ã‚¯ã‚»ã‚¹ã¯éåŠ¹ç‡ã¨ã„ã†ã‚ã‘ã§ã¯ãªã„ã§ã™ã€‚ä¾‹ãˆã°Rubyã ã¨æ¬¡ã®æ›¸ãæ–¹ã¯ã¨ã‚‚ã«æ–‡å­—åˆ—ã®æœ€å¾Œã‚’å–å¾—ã™ã‚‹å‡¦ç†ã§ã™ãŒã€å¾Œè€…ã®ã‚ˆã†ã«é«˜åŠ¹ç‡ã«æ›¸ãã“ã¨ãŒã§ãã¾ã™ã€‚

```ruby:performance.ruby
# æ–‡å­—åˆ—ãƒ•ãƒ«ã‚¹ã‚­ãƒ£ãƒ³èµ°ã‚‹ã®ã§é•·ã„æ–‡å­—åˆ—ã ã¨å‡¦ç†æ™‚é–“ã‹ã‹ã‚‹
s[s.length - 1]
# æœ«ç«¯ã‹ã‚‰1ç™ºã§ã‚¢ã‚¯ã‚»ã‚¹ã§ãã‚‹ã®ã§ã€é•·ã„æ–‡å­—åˆ—ã§ã‚‚ä¸€ç¬ã§å‡¦ç†ãŒçµ‚ã‚ã‚‹
s[-1]
```

---

ã“ã®ã‚ˆã†ã«ã€Indexã§æ–‡å­—åˆ—ç¯„å›²ã‚’æŒ‡å®šã™ã‚‹ã®ã¯ã€ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æ‹…ä¿ã®ãŸã‚ã®å¿…ç„¶ã§ã¯ãªãã€å˜ã«é«˜ã‚³ã‚¹ãƒˆãªæ“ä½œã§ã‚ã‚‹ã“ã¨ã‚’æ„è­˜ã—ã‚„ã™ã„ã‚ˆã†ã«ãªã£ã¦ã„ã‚‹ã ã‘ã¨ã„ã†ã“ã¨ã ã¨æ€ã£ã¦ã„ã¾ã™ã€‚

---

ã¾ãŸã€Swiftã®Stringã¯Character Viewãƒ™ãƒ¼ã‚¹ã«ãªã£ã¦ã„ã‚‹ã“ã¨ã‚’æ„è­˜ã—ãªãŒã‚‰æ‰±ãˆã°ã€Indexã§ã¯ãªãIntã§ç›´æ¥éƒ¨åˆ†æ–‡å­—åˆ—ã®ç¯„å›²æŒ‡å®šã—ã¦ã‚‚ç ´ç¶»ã—ãªã„ã§ã™ã€‚

```swift:string.swift
var str = "12345"

// æ¨™æº– String APIã«ä¹—ã£å–ã£ãŸæ›¸ãæ–¹
let start = str.index(after: str.startIndex)
let end = str.index(start, offsetBy: 2)
str[start..<end]
// â†’ "23"

// æ¬¡ã®æ›¸ãæ–¹ã¯ã§ããªã„ãŒä¸Šã®å‡¦ç†ã¯ã€ŒstartIndex + 1 ã€œ startIndex + 3ã€ã¨åŒã˜æ„å‘³ãªã®ã§æ¬¡ã®ã‚ˆã†ã«æ›¸ã‘ã¦ã‚‚è‰¯ã„ã‚ˆã†ã«æ€ãˆã‚‹
str[1..<3]
str.characters[1..<3]
// â†’ ç¾åœ¨ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã‚¨ãƒ©ãƒ¼ã«ãªã‚‹

// åŒæ§˜ã«ä»–ã®Viewã§ã‚‚ã€ãã‚Œãã‚Œã®Viewã®æ•°ãˆæ–¹ã§ã‚«ã‚¦ãƒ³ãƒˆã—ãŸã‚‚ã®ã¨ã„ã†ã“ã¨ã‚’ç†è§£ã—ãŸä¸Šã§ãªã‚‰ã€æ¬¡ã®ã‚ˆã†ã«Intã§subscriptã‚¢ã‚¯ã‚»ã‚¹ã—ã¦ã‚‚å•é¡Œç„¡ã„ã‚ˆã†ã«æ€ãˆã‚‹
str.unicodeScalars[1..<3]
// â†’ ç¾åœ¨ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã‚¨ãƒ©ãƒ¼ã«ãªã‚‹
```

---

ã¨ã¯ã„ãˆã€ã›ã£ã‹ãSwiftãŒãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã«æ°—ã‚’ä½¿ã£ãŸAPIè¨­è¨ˆã«ã—ã¦ã„ã‚‹ã®ã«ã€`str[1..<3]` ã®ã‚ˆã†ã«ã‚¢ã‚¯ã‚»ã‚¹ã§ãã‚‹`subscript`ãªã©ã‚’è¿½åŠ ã—ã¦ã—ã¾ã†ã®ã¯ã¡ã‚‡ã£ã¨èºŠèº‡ã—ã¾ã™ã€‚

---

å‰è¿°ã®é€šã‚Šãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã‚’æ„è­˜ã•ã›ã‚‹ã“ã¨ãŒæœ¬è³ªã¨ã„ã†ã“ã¨ã¯ã€ãã‚Œã‚’æ˜ç¤ºã™ã‚Œã°è‰¯ã„ã¨ã„ã†ã“ã¨ã§ã€æ¬¡ã®ã‚ˆã†ã«ãƒ©ãƒ™ãƒ«ä»˜ã(sequentialAccessã¨ã—ã¾ã—ãŸ)ã®subscriptã‚’å®šç¾©ã™ã‚Œã°è‰¯ã„ã®ã§ã¯ã¨æ€ã„ã¾ã—ãŸã€‚

```swift:performance.swift
extension String.CharacterView {
// ç¯„å›²å¤–ãƒã‚§ãƒƒã‚¯ã¯æœªå¯¾å¿œ
    public subscript(sequentialAccess range: Range<Int>) -> String.CharacterView {
        let lower = range.lowerBound
        let startIndex = index(self.startIndex, offsetBy: lower)
        let endIndex = index(startIndex, offsetBy: range.count)
        return self[startIndex..<endIndex]
    }

    public subscript(sequentialAccess index: Int) -> Character {
        return self[sequentialAccess: index..<index + 1].first!
    }
}

extension String {
    public subscript(sequentialAccess range: Range<Int>) -> String {
        return String(characters[sequentialAccess: range])
    }

    public subscript(sequentialAccess index: Int) -> String {
        return self[sequentialAccess: index..<index + 1]
    }
}

var str = "12345"
str[sequentialAccess: 1..<3]
// â†’ "23"
String(str.characters[sequentialAccess: 1..<3])
// â†’ "23"
```

---

ãƒ©ãƒ™ãƒ«ã§é€šå¸¸ã®æŒ™å‹•ã¨ã¯é•ã†ã“ã¨ã‚’æ˜ç¤ºã™ã‚‹ã®ã¯ https://github.com/apple/swift-evolution/blob/master/proposals/0080-failable-numeric-initializers.md ã®ã‚¤ãƒ‹ã‚·ãƒ£ãƒ©ã‚¤ã‚¶ãƒ¼ã§ã‚‚ææ¡ˆã•ã‚Œã¦ã„ã¾ã™ã—ã€åˆ†ã‹ã‚Šã‚„ã™ã„ã‹ãªã¨æ€ã£ã¦ã„ã¾ã™ã€‚

---

æ–‡å­—åˆ—ã®å§‹ç«¯ã‹ã‚‰ãƒ™ã‚¿ã«èµ°æŸ»ã™ã‚‹å‡¦ç†ã«ã®ã¿å¯¾å¿œã—ã¦ã„ã¦ã€`str[sequentialAccess: -1]` ãªã©ã§çµ‚ç«¯ã‹ã‚‰åŠ¹ç‡ã‚ˆãè¾¿ã‚Œã‚‹ã‚ˆã†ã«ãªã©ã‚‚ã‚µãƒãƒ¼ãƒˆã™ã‚‹ä½™åœ°ã‚‚ã‚ã‚Šã¾ã™ãŒã€ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æ°—ã«ãªã‚‹å‡¦ç†ã¯æ¨™æº–APIã‚’ãƒ™ã‚¿ã«ä½¿ãˆã°è‰¯ã„ã‹ãªã¨ã„ã†æ€ã„ãŒã‚ã‚Šã¾ã™ã€‚

---

ä¸€å¿œ https://github.com/mono0926/SwiftyStringExtension ã§å…¬é–‹ã—ã¦ã„ã¾ã™ãŒã€ã¾ã ã“ã£ãã‚Šè‡ªåˆ†ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã«ä½¿ã£ã¦ã„ã‚‹ã ã‘ã§å…¬ã«ã¯ãƒªãƒªãƒ¼ã‚¹ã—ã¦ã„ãªã„ã§ã™ã€‚
åˆ©ç”¨ã™ã‚‹å ´åˆã€ç½ ãŒæ½œã‚“ã§ã„ã‚‹å¯èƒ½æ€§ã‚‚ã‚ã‚‹ã®ã§ã€ã”æ³¨æ„ãã ã•ã„ã€‚

---

SwifterSwift ã§ã¯ã€ãƒ©ãƒ™ãƒ«ç„¡ã—ã®subscriptãƒ¡ã‚½ãƒƒãƒ‰ã‚’è¿½åŠ ã—ã¦ã„ã¾ã™ãŒã€æ¨™æº–APIã®ã”ã¨ãã‚«ã‚¸ãƒ¥ã‚¢ãƒ«ã«ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹å•é¡Œã«ãªã‚Šãã†ãªè¨˜è¿°ãŒã§ãã¦ã—ã¾ã†ã®ã§ã€ã¡ã‚‡ã£ã¨å±é™ºã‹ãªã¨æ€ã„ã¾ã—ãŸ(ä¾¿åˆ©ã§ã™ãŒ)ã€‚
https://github.com/omaralbeik/SwifterSwift/blob/master/Source/Extensions/StringExtensions.swift#L279-L310

---

ã¾ãŸã€Intã§Stringã®è¦ç´ ã«ã‚¢ã‚¯ã‚»ã‚¹ã—ã¦è‰¯ã„ã‹ã¨ã„ã†æ‡¸å¿µã¯ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ä»¥å¤–ã«ã‚‚NSStringã¨ã®ç›¸äº’é‹ç”¨ã«ã‚‚ã‚ã‚Šãã†ã§ã™ã€‚

---

æ¬¡ã®å ´åˆStringã«Range<Int>ã§ã‚¢ã‚¯ã‚»ã‚¹ã§ãã¦ã—ã¾ã†ã¨ã€Œå…ƒã®NSStringã®éƒ¨åˆ†æ–‡å­—åˆ—ã€ã¨ã€ŒNSRangeã‚’toRangeã¨ã„ã†æ¨™æº–ãƒ¡ã‚½ãƒƒãƒ‰ã§å¤‰æ›ã—ã¦Stringã‹ã‚‰å–å¾—ã—ãŸéƒ¨åˆ†æ–‡å­—åˆ—ã€ãŒé£Ÿã„é•ã„ã¾ã™ã€‚

```swift:nsstring2.swift
let str = "1ï¸âƒ£2ï¸âƒ£3ï¸âƒ£4ï¸âƒ£5ï¸âƒ£"

let nsRange = NSRange(location: 0, length: 3)
// â†’ "1ï¸âƒ£"

(str as NSString).substring(with: nsRange)
str[sequentialAccess: nsRange.toRange()!]
// â†’ "1ï¸âƒ£2ï¸âƒ£3ï¸âƒ£"
```

---

UITextViewãªã©æ‰±ã£ã¦ã„ã‚‹ã¨ã€APIã‹ã‚‰è¿”ã£ã¦ãã‚‹ãƒ¬ãƒ³ã‚¸ãŒNSRangeã ã£ãŸã‚Šã™ã‚‹ã®ã§ã€ãã‚Œã‚’å®‰æ˜“ã«Stringã«é©ç”¨ã—ã¦ã—ã¾ã†ã¨å–å¾—ã§ãã‚‹æ–‡å­—åˆ—ã‚’é–“é•ãˆãŸã‚Šã‚¯ãƒ©ãƒƒã‚·ãƒ¥ã—ã¦ã—ã¾ã†ã“ã¨ãªã©ã«ã¤ãªãŒã‚Šã¾ã™ã€‚

---

æ¨™æº–ã®substringãƒ¡ã‚½ãƒƒãƒ‰ã¯ã€Range<String.index>ã‚’å—ã‘ã‚‹ã‚ˆã†ã«ãªã£ã¦ã„ã¦Range<Int>ã¯å—ã‘ä»˜ã‘ãªã„ãŸã‚ã€å…ˆã»ã©ã®ãƒŸã‚¹ã¯ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã‚¨ãƒ©ãƒ¼ã§é˜²ã’ã¾ã™ã€‚Stringã‚’ã€Œä¾¿åˆ©ã€ã«ã—ãŸéš›ã¯ã“ã®ã‚ãŸã‚Šã«ã‚‚æ°—ã‚’ä»˜ã‘ã‚‹å¿…è¦ãŒå‡ºã¦ãã¾ã™ã€‚

---

ã¡ãªã¿ã«ã©ã†ã™ã‚‹ã®ãŒè‰¯ã„ã‹ã¨ã„ã†ã¨ã€2ã¤ã®æ–¹æ³•ãŒè€ƒãˆã‚‰ã‚Œã¾ã™ã€‚
1ã¤ã‚ã¯ã€Stringã‚’NSStringã«ã‚­ãƒ£ã‚¹ãƒˆã—ã¦ã‹ã‚‰NSRangeã§éƒ¨åˆ†æ–‡å­—åˆ—å–å¾—ã™ã‚‹ã‚„ã‚Šæ–¹ã§ã™ã€‚

---

2ã¤ã‚ã¯ã€NSRangeã¯UTF16ã®Indexç¯„å›²ã§ã‚ã‚‹ã®ã§ã€ãã‚Œã‚’å…ƒã«é©åˆ‡ãªRange<Int>ã«å¤‰æ›ã—ã¦ã€Stringã‹ã‚‰éƒ¨åˆ†æ–‡å­—åˆ—å–å¾—ã™ã‚‹ã‚„ã‚Šæ–¹ ( https://medium.com/swift-column/swift-string-16245b2723b4#.achuihxel ã«è¨˜è¼‰ )ã§ã™ã€‚

---

NSãƒ—ãƒ¬ãƒ•ã‚£ãƒƒã‚¯ã‚¹ç³»ã®å‹ã‚’æ¥µåŠ›æ‰±ã„ãŸããªã‹ã£ãŸã®ã§ã€åƒ•ã¯å¾Œè€…ã‚’é¸æŠã—ã¦ã„ã¾ã™ãŒ1ã¤ã‚ã®ã‚„ã‚Šæ–¹ã®æ–¹ãŒç´ ç›´ãªæ°—ã‚‚ã—ã¦ã„ã¾ã™ğŸ¤”

---

ä»¥ä¸Šã§ã€ç¾çŠ¶ã®Swiftã®String APIã®æ‰±ã„ã®ã—ã«ãã•ã®æœ¬è³ªã¯ã©ã“ã«ã‚ã‚‹ã®ã‹ã®èª¬æ˜ã¨ã€ãã‚Œã«å¯¾ã™ã‚‹è‡ªåˆ†ã®ã‚¢ãƒ—ãƒ­ãƒ¼ãƒã‚’ç´¹ä»‹ã—ã¾ã—ãŸã€‚

---

åˆ¥è§£ã¨ã—ã¦ã¯ã€ @koher ã•ã‚“ãŒã“ã£ãã‚Šå…¬é–‹ã—ã¦ã„ã‚‹ https://github.com/koher/easy-text ã®ã‚¢ãƒ—ãƒ­ãƒ¼ãƒã‚‚è‰¯ã„ãªã¨æ€ã„ã¾ã—ãŸã€‚
åˆæœŸåŒ–æ™‚ã«Stringã®Character Viewã‚’ã€Arrayã¨ã—ã¦ä¿æŒã—ã¦ã—ã¾ã†ã€ã¨ã„ã†å¯Œè±ªçš„ãªå®Ÿè£…ã«ãªã£ã¦ã„ã¾ã™ã€‚

---

ã‚¤ãƒ‹ã‚·ãƒ£ãƒ©ã‚¤ã‚¶ãƒ¼ã§æ–‡å­—åˆ—å…¨ã‚¹ã‚­ãƒ£ãƒ³ã™ã‚‹ãŸã‚O(n)ã¨ãªã£ã¦ã„ã¦( https://github.com/koher/easy-text/blob/master/Sources/Text.swift#L4-L6 )ã‚¤ãƒ¬ã‚®ãƒ¥ãƒ©ãƒ¼ãªã®ã§å®Ÿéš›ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã¨ã—ã¦å…¬é–‹ã™ã‚‹å ´åˆã€ãã®æ—¨ã‚’ã‚³ãƒ¡ãƒ³ãƒˆã«æ›¸ã„ã¦ã‚ã‚‹ã¨è‰¯ã„ã‹ãªã¨æ€ã„ã¾ã—ãŸã€‚

---

ã¾ãŸã€ä»–ã®è¨€èªã§ã‚‚ãŠãã‚‰ãæ–‡å­—åˆ—ã®åˆæœŸåŒ–æ™‚ã«ãã®å…¨ã‚¹ã‚­ãƒ£ãƒ³ãŒã‹ã‹ã‚‹ã‚ˆã†ã«ãªã£ã¦ã„ã‚‹ã®ã¯çã—ã„ã¯ãšãªã®ã§å–ã‚Šæ‰±ã„ã«ã¯æ³¨æ„ã§ã™ãŒã€æ™®æ®µå¤šãæ‰±ã†ã‚ˆã†ãªå¤§ã—ãŸé•·ã•ã§ã¯ç„¡ã„æ–‡å­—åˆ—å‡¦ç†ã¯ã™ã”ãã‚„ã‚Šã‚„ã™ããªã‚Šãã†ã§è‰¯ã„ã¨æ€ã„ã¾ã—ãŸã€‚

---

ã‚ã‚‹ã„ã¯ã€`NSString`ã«ã‚­ãƒ£ã‚¹ãƒˆã™ã‚‹ã¨Intã§ç¯„å›²æŒ‡å®šã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ãŒã€æŠ½è±¡æ–‡å­—ãŒUTF16ä¸€æ–‡å­—ã§è¡¨ç¾ã§ãã‚‹æ™‚ã—ã‹ä½¿ãˆãªã‹ã£ãŸã‚Šå¾®å¦™ã§ã™(ãã‚‚ãã‚‚NSãƒ—ãƒ¬ãƒ•ã‚£ãƒƒã‚¯ã‚¹ã®å‹ã¯æ¥µåŠ›ä½¿ã‚ãªã„æ–¹ãŒè‰¯ã„ã§ã™ã­)

```swift:nsstring.swift
var str = "12345"

// NSStringã¯UTF16ãªã®ã§ã€æ¬¡ãŒæº€ãŸã™ã‚ˆã†ãªæ™‚ã®ã¿NSStringã«ã‚­ãƒ£ã‚¹ãƒˆã—ã¦å¯¾å‡¦ã‚‚ã§ããã†
str.characters.count == str.utf16.count

// 2å›ã‚­ãƒ£ã‚¹ãƒˆå¿…è¦ã«ãªã£ã¦é¢å€’
((str as NSString).substring(from: 1) as NSString).substring(to: 2)
// â†’ "23"

// NSRangeä½¿ã†æ–¹æ³•
(str as NSString).substring(with: NSRange(location: 1, length: 2))
// â†’ "23"
```

---

ã•ãã»ã©ã®NSStringã®ã‚³ãƒ¼ãƒ‰ä¾‹è¦‹ã‚‹ã¨åˆ†ã‹ã‚‹é€šã‚Šã€ãã†ã„ãˆã°Objective-Cæ™‚ä»£ã‹ã‚‰æ–‡å­—åˆ—å‡¦ç†ã¯ã‚„ã‚Šã«ããã¦ã€ãã‚Œã«é–‹ç™ºè€…ãŒæ…£ã‚Œã¦ã—ã¾ã£ã¦ã„ã‚‹æ„Ÿã‚‚ã‚ã‚‹ã‹ãªã¨æ€ã„ã¾ã—ãŸ(ã€€Â´ï½¥â€¿ï½¥ï½€)
ä»Šå¾ŒSwiftã®æ¨™æº–APIãŒæ”¹å–„ã•ã‚Œã¦ã„ãã®ã‚’æœŸå¾…ã—ã¦ã„ã¾ã™ã€‚

---

https://github.com/apple/swift-evolution/blob/master/README.md ã®ã€ŒString re-evaluationã€ã¨ã„ã†é …ç›®ã«ã‚‚æ³¨ç›®ã§ã™ã€‚

---

Swift 4ã§æ–‡å­—åˆ—å‘¨ã‚Šã«å¤‰æ›´ã‚ã‚Šãã†ãªè¨˜è¿°ã§ã™ãŒã€ã‚ã¾ã‚Šå‹•ããŒç„¡ã„ã®ã§é–“ã«åˆã‚ãš5ä»¥é™ã«ãªã‚‹ã‹ã‚‚ã¨æ€ã£ã¦ã„ã¾ã™ã€‚

> Swift 4 seeks to make strings more powerful and easier-to-use...

---

ä»¥ä¸Šã€æ”¹ã‚ã¦Swiftã®æ–‡å­—åˆ—å‡¦ç†ã«å‘ãåˆã£ã¦ã¿ã¾ã—ãŸãŒã€ç¾çŠ¶åˆå­¦è€…ãŒè§¦ã‚Œã‚‹éš›ã®æœ€ã‚‚å¤§ããªé–¢é–€ã®ä¸€ã¤ã«ãªã‚‹ç¨‹åº¦ã«ã¯æ‰±ã„ã«ãã„ã¨æ€ã„ã¾ã—ãŸã€‚Swift 3ã¾ã§ã®å¤‰æ›´ã®å¤šã•ã‚‚ã‚ã„ã¾ã£ã¦ã€é©å½“ã«ããã£ã¦æ‰€æœ›ã®æ–‡å­—åˆ—å‡¦ç†ã‚’ã™ã‚‹ã¾ã§ã‹ãªã‚Šè‹¦åŠ´ã—ãã†ã§ã™ã€‚

---

å°‘ã—æ ãŒä½™ã£ãŸã®ã§ã€æœ€å¾Œã«Swiftã«é™ã‚‰ãšã§ã™ãŒæ‚©ã¾ã—ã„æ–‡å­—åˆ—ã®ã‚«ã‚¦ãƒ³ãƒˆå•é¡Œã«ã¤ã„ã¦è§¦ã‚Œã¦ã„ãã¾ã™ã€‚

---

Swiftã¯å¾Œç™ºãªã ã‘ã‚ã£ã¦ã€è‰¯ãå‡ºæ¥ã¦ã„ã¾ã™ã€‚Viewã§è¡¨ç¾ãŒåˆ†ã‹ã‚Œã¦ã„ã‚‹ã®ã¯å‰è¿°ã®é€šã‚Šã§ã™ãŒã€æ¬¡ã®"ğŸ‡¯ğŸ‡µ"ã®ã‚ˆã†ã«è¤‡æ•°ã®ã‚³ãƒ¼ãƒ‰ãƒã‚¤ãƒ³ãƒˆ(unicode scalar)ã‚’çµ„ã¿åˆã‚ã›ãŸã‚‚ã®ã«ã‚‚æ¦‚ã­å¯¾å¿œã—ã¦ã„ã¾ã™ã€‚

```swift:emoji1.swift
do {
    let str = "ğŸ‘"
    str.characters.count // 1
    str.unicodeScalars.count// 1
    str.utf8.count // 4
    str.utf16.count // 2

    str.unicodeScalars.map { String($0.value, radix: 16) }
    // â†’ "1f44d"
}

do {
    let str = "ğŸ‡¯ğŸ‡µ"
    str.characters.count // 1
    str.unicodeScalars.count // 2
    str.utf8.count // 8
    str.utf16.count // 4

    str.unicodeScalars.map { String($0.value, radix: 16) }
    // â†’ "1f1ef", "1f1f5"
}
```

---

ãŸã ã€æœªå¯¾å¿œã®ã‚‚ã®ã‚‚ã‚ã£ã¦ã€ğŸ‘ğŸ¼(è‚Œãƒˆãƒ¼ãƒ³ä»˜ã)ã‚„ğŸ‘©â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦(è¤‡æ•°çµµæ–‡å­—ã®é€£çµ)ã¯ã€characters.countã§ã¯è¤‡æ•°æ‰±ã„ã«ãªã£ã¦ã—ã¾ã„ã¾ã™ã€‚

```swift:emoji2.swift
do {
    let str = "ğŸ‘ğŸ¼"
    str.characters.count // 2
    str.unicodeScalars.count // 2
    str.utf8.count // 8
    str.utf16.count // 4

    str.unicodeScalars.map { String($0.value, radix: 16) }
    // â†’ "1f44d", "1f3fc"
}
do {
    let str = "ğŸ‘©â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦"
    str.characters.count // 4
    str.unicodeScalars.count // 7
    str.utf8.count // 25
    str.utf16.count // 11

    str.unicodeScalars.map { String($0.value, radix: 16) }
    // â†’ "1f469", 200d", "1f469", "200d", "1f467, "200d", "1f466"
}
```

---

ã“ã®ã‚ãŸã‚Šã¯è‡ªå‰ã§ã‚„ã‚‹ã—ã‹ãªã„ã‹ã¨ã„ã†ã¨ãã†ã§ã¯ãªãã€ `enumerateSubstrings(in:options:_:)` ã«ã¦åˆ—æŒ™ã™ã‚‹ã¨ã€ã¨ã‚‚ã«æ­£ã—ã1æ–‡å­—æ‰±ã„ã•ã‚Œã¾ã™ã€‚

https://developer.apple.com/reference/swift/string/1643111-enumeratesubstrings

---

ãŸã ã€ã“ã®ãƒ¡ã‚½ãƒƒãƒ‰ã§å³å¯†ã«æ•°ãˆã‚‹ã®ãŒå¸¸ã«æ­£è§£ã‹ã¨ã„ã†ã¨ã€ãƒãƒ«ãƒãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ã®å ´åˆã¯å¿…ãšã—ã‚‚ãã†ã§ã¯ãªãå„ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ãƒ»ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®æ‰±ã„ã‚„ã™ã•ãªã©è¸ã¾ãˆã¦ã€è‰¯ã„æ„Ÿã˜ã«å¦¥å”ä»•æ§˜ã«ã™ã‚‹ã®ãŒç¾å®Ÿçš„ã‹ãªã¨æ€ã£ã¦ã„ã¾ã™ã€‚

---

ã¡ãªã¿ã«åƒ•ã®Twitteråã¯ã€ç¾åœ¨"ğŸ¶Monor SwiftğŸ¶ğŸğŸ’»ğŸ“±âŒšï¸"ã«ã—ã¦ã„ã¾ã™ãŒã€Webã§ã¯å…¥åŠ›å‡ºæ¥ãŸã‚‚ã®ã®iOSç‰ˆã§ã¯ã™ã§ã«æ–‡å­—æ•°ã‚ªãƒ¼ãƒãƒ¼ã§ç·¨é›†ã§ããªãã¦ä¸ä¾¿ã§å›°ã£ã¦ã„ã¾ã™ã€‚iOSç‰ˆã§ã¯NSStringã§ã‚«ã‚¦ãƒ³ãƒˆ(UTF16ã§ã®ã‚«ã‚¦ãƒ³ãƒˆ)ã—ã¦ãã†ã§ã™ğŸ‘€

---

æ–°ã—ã‚ã®çµµæ–‡å­—ãªã©ã®ã‚«ã‚¦ãƒ³ãƒˆã«è¿½å¾“ã§ãã¦ã„ãªã„ã®ã¯ä»•æ–¹ãªã„ã§ã™ãŒã€ã›ã‚ã¦ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ã§æƒãˆã‚‹åŠªåŠ›ã¯ã—ã¦æ¬²ã—ã„ãªã¨æ€ã„ã¾ã—ãŸã€‚

---

æœ€å¾Œã¡ã‚‡ã£ã¨ä½™è«‡ã«ãªã‚Šã¾ã—ãŸãŒã€ç™ºè¡¨ã¯ä»¥ä¸Šã§ã™ã€‚
ã”é™è´ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã—ãŸ(ã€€Â´ï½¥â€¿ï½¥ï½€)